graph TD
  %% nodes with styles
  raw([raw data]):::source

  subgraph calcofi[CalCOFI.io]
    db[(database)]:::database
    web[calcofi.org]:::website
    api[APIs]:::api
    lib[library]:::code
    app[apps]:::code
    flow[workflows]:::code
  end

  subgraph portals[Portals]
    edi[EDI]:::portal
    obis[OBIS]:::portal
    erddap[ERDDAP]:::portal
    ncei[NCEI]:::portal
  end

  subgraph meta[Meta-Portals]
    odis[ODIS]:::metaportal
    datagov[data.gov]:::metaportal
  end

  %% edges
  raw --> db
  db  --> api
  db  --> web
  api --> lib
  api --> app
  api --> flow
  flow  --> portals
  portals -->|sitemap| odis
  portals --> datagov

  %% Custom styles
  classDef source fill:#E0E7FF,stroke:#6366F1,stroke-width:2px
  classDef database fill:#FEF3C7,stroke:#D97706,stroke-width:2px
  classDef website fill:#F3E8FF,stroke:#9333EA,stroke-width:2px
  classDef api fill:#E0E7FF,stroke:#6366F1,stroke-width:2px
  classDef code fill:#DBEAFE,stroke:#3B82F6,stroke-width:2px
  classDef portal fill:#F0FDF4,stroke:#22C55E,stroke-width:2px
  classDef metaportal fill:#FEF2F2,stroke:#DC2626,stroke-width:2px

  %% Style subgraphs
  style calcofi fill:#F8FAFC,stroke:#CBD5E1,stroke-width:2px
  style portals fill:#F8FAFC,stroke:#CBD5E1,stroke-width:2px
  style meta fill:#F8FAFC,stroke:#CBD5E1,stroke-width:2px
